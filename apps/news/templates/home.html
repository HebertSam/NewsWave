{% extends "base.html" %}
{% block content %}
<style>
    
</style>
{% for outlet in outlets %}
        <script>
            $(document).ready(function(){
                $.ajax({
                    url: "https://newsapi.org/v1/articles?source={{outlet.sourceId}}&apiKey=4d48612e30ef4e4f8a55c0d6e6f984ef",
                    method: "GET"
                })
                .done(function(source){
                    var stories = source.articles;
                    var parentNode = $("#{{outlet.sourceId}} .stories");
                    var len = stories.length;
                    if(len > 10){
                        len = 10;
                    }
                    for(var i = 0; i < len; i++){
                        var story = stories[i];
                        var titleString = "<a href='" + story.url + "'>" + story.title + "</a><br />";
                        var imgString = "<img src='" + story.urlToImage + "'/><br />";
                        var descString = "<p>" + story.description + "</p>";
                        parentNode.append(titleString + imgString + descString);
                    }
                });
            });
        </script>
    {% endfor %}
    {% if locations %}
        {% for location in locations %}
            <div class="location"></div>
        {% endfor %}
    {% endif %}
    {% if outlets %}
        {% for outlet in outlets %}
            <div class="outlet" id = "{{outlet.sourceId}}">
                <h2>{{outlet.sourceName}}</h2>
                <div class="stories"></div>
            </div>
        {% endfor %}
    {% endif %}
    {% if notes %}
        {% for notes in notes %}
            <div class="note"></div>
        {% endfor %}
    {% endif %}
{% endblock content %}